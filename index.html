<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Photobox Kemerdekaan RI ke-80</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/dist/confetti.browser.min.js"></script>
</head>
<body class="bg-red-600 min-h-screen flex flex-col items-center justify-center p-4">

  <!-- Area Photo -->
  <div id="photobox" class="relative w-full max-w-3xl aspect-video bg-white rounded-xl overflow-hidden shadow-xl border-8 border-white">
    <video id="video" autoplay playsinline class="absolute inset-0 w-full h-full object-cover"></video>

    <!-- Ornamen -->
    <img src="https://upload.wikimedia.org/wikipedia/commons/9/9f/Flag_of_Indonesia.svg" 
         class="absolute top-4 left-4 w-24 drop-shadow-lg" alt="Bendera">
    <img src="https://upload.wikimedia.org/wikipedia/commons/1/16/Garuda_Pancasila_emblem.svg" 
         class="absolute top-4 right-4 w-20 drop-shadow-lg" alt="Garuda">
    
    <!-- Bingkai bawah -->
    <div class="absolute bottom-0 w-full bg-gradient-to-t from-red-800/90 to-transparent text-center p-4">
      <h1 class="text-white text-2xl font-bold">Dirgahayu Republik Indonesia ke-80</h1>
      <p class="text-white font-semibold">RT 004 / RW 008</p>
    </div>

    <!-- Countdown -->
    <div id="countdown" class="hidden absolute inset-0 flex items-center justify-center bg-black/50 text-white text-8xl font-bold"></div>
  </div>

  <!-- Tombol -->
  <div class="mt-4 flex gap-4">
    <button id="captureBtn" class="px-6 py-3 bg-white rounded-lg font-bold shadow-lg hover:bg-gray-200">üì∏ Mulai Foto</button>
    <button id="downloadBtn" class="px-6 py-3 bg-yellow-400 rounded-lg font-bold shadow-lg hover:bg-yellow-500 hidden">‚¨áÔ∏è Unduh Foto</button>
  </div>

  <script>
    const video = document.getElementById('video');
    const captureBtn = document.getElementById('captureBtn');
    const downloadBtn = document.getElementById('downloadBtn');
    const photobox = document.getElementById('photobox');
    const countdown = document.getElementById('countdown');

    // Akses webcam
    navigator.mediaDevices.getUserMedia({ video: true })
      .then(stream => video.srcObject = stream)
      .catch(err => alert('Gagal mengakses kamera: ' + err));

    // Countdown sebelum foto
    function startCountdown(cb) {
      let count = 3;
      countdown.textContent = count;
      countdown.classList.remove('hidden');
      const interval = setInterval(() => {
        count--;
        if (count > 0) {
          countdown.textContent = count;
        } else {
          clearInterval(interval);
          countdown.classList.add('hidden');
          cb();
        }
      }, 1000);
    }

    // Ambil foto + ornamen
    captureBtn.addEventListener('click', () => {
      startCountdown(() => {
        html2canvas(photobox).then(canvas => {
          window.capturedImage = canvas.toDataURL('image/png');
          video.style.display = 'none';
          const imgPreview = document.createElement('img');
          imgPreview.src = window.capturedImage;
          imgPreview.className = 'absolute inset-0 w-full h-full object-cover';
          photobox.appendChild(imgPreview);
          downloadBtn.classList.remove('hidden');

          // Confetti merah-putih
          confetti({ particleCount: 150, spread: 80, origin: { y: 0.6 }, colors: ['#ff0000', '#ffffff'] });
        });
      });
    });

    // Download foto
    downloadBtn.addEventListener('click', () => {
      const a = document.createElement('a');
      a.href = window.capturedImage;
      a.download = 'Photobox_HUTRI80.png';
      a.click();
    });
  </script>

</body>
</html>
